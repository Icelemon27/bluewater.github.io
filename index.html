<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bridge - 智能数据分析工具</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header and Navigation */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }
        
        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .nav-links a:hover {
            color: #667eea;
        }
        
        /* Main Content */
        main {
            background: white;
            margin-top: 80px;
        }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2.5rem 0;
        }
        
        .hero-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
        }
        
        .hero-text {
            text-align: left;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 400;
            line-height: 1.3;
        }
        
        .hero .subtitle {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            line-height: 1.5;
        }
        
        .cta-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .cta-button {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-block;
            font-size: 0.9rem;
        }
        
        .cta-primary {
            background: #4285f4;
            color: white;
            border: none;
        }
        
        .cta-primary:hover {
            background: #3367d6;
        }
        
        .cta-secondary {
            background: #333;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .cta-secondary:hover {
            background: #555;
        }
        
        .hero-preview {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .preview-title {
            font-size: 1rem;
            margin-bottom: 0.8rem;
            opacity: 0.9;
        }
        
        .preview-placeholder {
            background: rgba(255, 255, 255, 0.2);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 2rem 1rem;
            margin-bottom: 0.8rem;
        }
        
        .preview-note {
            font-size: 0.85rem;
            opacity: 0.7;
            font-style: italic;
        }
        
        /* Sections */
        section {
            padding: 3rem 0;
        }
        
        .section-title {
            font-size: 2.5rem;
            color: #333;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 50px;
            height: 3px;
            background: #667eea;
            margin: 1rem auto;
        }
        
        /* Problem Section */
        .problem-section {
            background: #f8f9fa;
        }
        
        .dialogue {
            background: white;
            padding: 1rem 1.5rem;
            margin: 0.5rem 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .speaker {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }
        
        .internal-thought {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem 1.5rem;
            margin: 0.5rem 0;
            font-style: italic;
            border-radius: 10px;
        }
        
        /* Instructions Section */
        .instructions {
            background: white;
        }
        
        .step {
            background: #f8f9fa;
            margin: 1rem 0;
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .step-number {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 1rem;
        }
        
        .sub-section {
            margin: 1.5rem 0;
            padding-left: 0;
        }
        
        .sub-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin: 1.5rem 0 0.8rem 0;
            padding-left: 1rem;
            border-left: 3px solid #667eea;
        }
        
        .sub-content {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }
        
        .detail-item {
            margin: 1rem 0;
            padding: 0.8rem 0;
        }
        
        .detail-title {
            font-weight: 600;
            color: #555;
            margin-bottom: 0.5rem;
        }
        
        .detail-description {
            margin-left: 0;
            color: #666;
            line-height: 1.6;
        }
        
        .data-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .data-type-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .data-type-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .data-type-title {
            color: #667eea;
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        
        /* Example Buttons */
        .example-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            margin: 0.5rem 0;
            transition: background 0.3s ease;
        }
        
        .example-btn:hover {
            background: #218838;
        }
        
        .example-content {
            display: none;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 5px;
        }
        
        .example-content.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 200px;
            }
        }
        
        /* Rules Section */
        .rules-table {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
        }
        
        .rules-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .rules-table th {
            background: #667eea;
            color: white;
            padding: 1rem;
            text-align: left;
        }
        
        .rules-table td {
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .rules-table tr:hover {
            background: #f8f9fa;
        }
        
        /* Features Section */
        .features {
            background: #f8f9fa;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        /* Footer */
        footer {
            background: #333;
            color: white;
            text-align: center;
            padding: 2rem 0;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .hero-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .hero h1 {
                font-size: 1.8rem;
            }
            
            .hero .subtitle {
                font-size: 1rem;
            }
            
            .cta-buttons {
                flex-direction: column;
            }
            
            .data-types {
                grid-template-columns: 1fr;
            }
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">Bridge</div>
            <ul class="nav-links">
                <li><a href="#home">首页</a></li>
                <li><a href="#problem">问题场景</a></li>
                <li><a href="#instructions">使用说明</a></li>
                <li><a href="#data-types">数据类型</a></li>
                <li><a href="#rules">运算规则</a></li>
                <li><a href="#process">计算逻辑</a></li>
                <li><a href="#features">功能特色</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <!-- Hero Section -->
        <section id="home" class="hero">
            <div class="container">
                <div class="hero-content">
                    <div class="hero-text">
                        <h1>Bridge – 在财务，市场，大数据等各种分析领域帮助你自动分析找到关键驱动因素</h1>
                        <p class="subtitle">几分钟内完成拆解，生成 Waterfall 与贡献分析，过程透明可追溯。</p>
                        <div class="cta-buttons">
                            <a href="#instructions" class="cta-button cta-primary">开始使用</a>
                            <a href="#problem" class="cta-button cta-primary">案例介绍</a>
                            <a href="#" class="cta-button cta-secondary">
                                <span>🏪</span> Microsoft Store 下载
                            </a>
                        </div>
                    </div>
                    <div class="hero-preview">
                        <div class="preview-title">Waterfall & Contribution 预览 / Preview</div>
                        <div class="preview-placeholder">
                            <div style="font-size: 2rem; margin-bottom: 1rem;">📊</div>
                            <div>Waterfall 图表预览区域</div>
                        </div>
                        <div class="preview-note">上图为占位示意，可替换为你的截图或动态图。</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Problem Section -->
        <section id="problem" class="problem-section">
            <div class="container">
                <h2 class="section-title">案例介绍</h2>
                
                <div class="dialogue">
                    <div class="speaker">你是否经常碰到以下类似的问题？</div>
                    
                    <div class="conversation">
                        <div class="speaker">Boss:</div>
                        <p>这几季度我们的利润率情况如何？</p>
                        
                        <div class="speaker">You:</div>
                        <p>销售额增长了10%，但是利润率整体下降了7pt.</p>
                        
                        <div class="speaker">Boss:</div>
                        <p>这可不太好，你能给我一个利润率下降7pt的拆解和分析报告吗？我需要知道是什么具体产品，什么原因导致了这些下降。最好能够分区域，分产品类型，渠道，或者是团队等其他维度做一个全面的类似分析，你可以和不同的时间段进行对比，比如去年，前年，或者我们的预算。这样让我们能够及时的发现问题并立即解决它。</p>
                        
                        <div class="internal-thought">
                            <div class="speaker">You (心中暗想):</div>
                            <p>如果是收入分析倒是很简单，但是如果把利润率7pt的下降拆解到具体的1000个SKU，并且要知道是价格，折扣率，成本等等哪个因素贡献了多少总体下降的pt，那可是一件很不容易的事情，如果再分区域，产品类型，渠道等，就更复杂了。然后还需要和去年，预算等不同版本的数据进行对比，简直不可能…</p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <p><strong>上面类似的需求是否经常在工作中经常遇见？</strong>是否会花费你一整天，或者几天时间甚至更长（不同维度的分析）才能得到一个分析结论。是否这个分析中包含了大量的人为估算，并且最后汇总所有的影响因素得到的利润率下降并不是准确的7pt，而你必须人为的进行调整，并且总数抱有一种不能100%确认计算过程是否正确的怀疑？</p>
                        
                        <p><strong>请使用Bridge，几分钟内就能完成类似的分析</strong>，通过算法等到准确的分析结果，并将收入，利润率变化等拆解成你希望的影响因素，不同的维度，以及不同的scenarios对比。让你精准的找到问题所在，及时行动，提高企业的竞争力。</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Instructions Section -->
        <section id="instructions" class="instructions">
            <div class="container">
                <h2 class="section-title">使用说明</h2>
                <p style="text-align: center; font-size: 1.1rem; margin-bottom: 2rem; color: #666;">下面的步骤详细地说明了如何使用bridge 软件进行分析</p>
                
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>初始面板操作</strong>
                    <p>初始面板上显示两个按钮"新建Bridge文件" 和"打开已有Bridge文件"</p>
                    <div style="margin-left: 2rem; margin-top: 1rem;">
                        <p><strong>1.1</strong> 点击"新建Bridge文件"按钮 - 生成一个新的excel文件，其中包含一个新的"Data"工作表。请在"Data"工作表中输入相应的数据，并以此作为进一步的分析。</p>
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <strong>Data工作表</strong>
                    <p>请在Data工作表的第二列开始输入数据类型，字段名，和数据。第一列为每一行的应输入数据的标识。</p>
                    
                    <div class="sub-section">
                        <div class="sub-title">2.1 数据类型选择</div>
                        <div class="sub-content">
                            <p>请在"Data"工作表的第一行生成的下拉菜单中，从B列开始，选择数据的类型，类型根据数据需要表示的含义而定。程序将根据数据的类型进行自动分析。</p>
                            
                            <p>现在以我们的模拟超市的数据为例，讲解每种数据类型的含义：</p>
                            
                            <button class="example-btn" onclick="toggleExample('dataset-example')">查看数据集创建案例</button>
                            <div id="dataset-example" class="example-content">
                                <h4>模拟超市数据示例：</h4>
                                <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
                                    <thead>
                                        <tr style="background: #f8f9fa;">
                                            <th style="border: 1px solid #ddd; padding: 8px;">列</th>
                                            <th style="border: 1px solid #ddd; padding: 8px;">数据类型</th>
                                            <th style="border: 1px solid #ddd; padding: 8px;">字段名</th>
                                            <th style="border: 1px solid #ddd; padding: 8px;">示例数据</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ddd; padding: 8px;">B</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Dimension</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Date</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">2024-01-01</td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #ddd; padding: 8px;">C</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Key</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Product</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Apple</td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #ddd; padding: 8px;">D</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">SumY</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Quantity</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">100</td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #ddd; padding: 8px;">E</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">SumN</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Price</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">5.0</td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #ddd; padding: 8px;">F</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Result</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">Sales</td>
                                            <td style="border: 1px solid #ddd; padding: 8px;">=D*E</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <p>数据的类型分为5种："Dimension","Key", "SumY","SumN","Result"。每一个字段需要定义一种数据类型。每种类型的定义如下：</p>
                        </div>
                        
                        <div class="detail-item">
                            <div class="detail-title">2.1.1 Dimension</div>
                            <div class="detail-description">
                                表示数据的维度，例如日期，时间，区域等数据的维度和切面，这些字段不参与计算，只用来筛选数据。
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="detail-title">2.1.2 Key</div>
                            <div class="detail-description">
                                Key是Dimension的一种，只能有一个字段被标为Key。被标为Key的字段会作为分析的最小颗粒度，并在这个维度上计算每个因素对最终结果(Result)的影响。可以改变其他dimension 为Key 字段，进行不同颗粒度的分析。
                                <br><br>
                                <strong>例如：</strong>如果将区域选为Key，则Bridge工具将会计算每个变量在这个区域这个维度上的变化对最终结果(Result)的影响。
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="detail-title">2.1.3 SumY</div>
                            <div class="detail-description">
                                可以加总变量并且有意义有同样含义的变量，程序将根据变量的变化计算出对最终结果(Result)的影响。
                                <br><br>
                                <strong>例如：</strong>每一行不同产品的Quantity可以加总， 加总后含义为总商品的数量。因此Quantity的Type可以设置为SumY。
                                <br><br>
                                SumY中可以直接输入数值，也可以使用公式通过其他的字段计算出数值。但是公式中只能有Excel中使用的加减乘除四则运算符号以及括号，也就是：加+，减-，乘*，除/，左括号"("，右括号")"。
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="detail-title">2.1.4 SumN</div>
                            <div class="detail-description">
                                Raw Data的一种，但是这类型的数据无法在不同的产品，区域等Key之间相加。例如，Price 是一个Non-additive数据，不同的产品的Price并不一样，如果要计算所有产品的平均Price，并不能直接将A产品的Price 加上B 产品的Price 直接得到整体的Price。
                                <br><br>
                                但是每一行不同产品的Price不可以加总，并不是平均价格或者加权平均价格，因此加总后的结果没有任何意义。因此Price 字段的Data Type应设为SumN。
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="detail-title">2.1.5 Result</div>
                            <div class="detail-description">
                                只能有一个字段被选择为Result作为我们需要分析的数据结果。Result这一列这里必须输入公式，通过其他的变量计算出Result字段。
                                <br><br>
                                <strong>例如：</strong>如果Result字段的内容是sales，那么单元格需要输入 = Price * Quantity。或者是margin%，那么单元格需要输入=profit / revenue。
                                <br><br>
                                Result里的公式是Bridge工具用来关联变量及结果，以及分析逻辑依赖的重要信息。请确保在每一行的Result单元格中都含有可以计算出Result的公式，公式应该简洁清晰。
                                <br><br>
                                公式中只能有Excel中使用的加减乘除四则运算符号以及括号，也就是：加+，减-，乘*，除/，左括号"("，右括号")"。
                                <br><br>
                                <strong>注意：</strong>请注意，每一个Raw Data, Non-additive, Result单元格中的公式，只能使用同一行的其他变量，公式中不能包含跨行的数据。
                                <br><br>
                                Result 会分析公式中每个变量对Result的影响，而不在公式中的变量则并不在分析范围内。Result 公式中至少应该有一个字段的Data Type 是 SumY，这样才能把不同行的数据进行汇总分析。
                            </div>
                        </div>
                    </div>
                    
                    <div class="sub-section">
                        <div class="sub-title">2.2 字段名设置</div>
                        <div class="sub-content">
                            <p>在"Data"工作表的第二行输入字段名，第一行的Data Type需要根据字段的含义做相应的下拉选项的选择。</p>
                        </div>
                    </div>
                    
                    <div class="sub-section">
                        <div class="sub-title">2.3 数据输入</div>
                        <div class="sub-content">
                            <p>在"Bridge Data"工作表的第三行开始，往下的所有行都输入具体的数据。</p>
                        </div>
                    </div>
                </div>
                
                <div class="step" style="margin-top: 1rem;">
                    <div style="margin-left: 1rem;">
                        <p><strong>1.2</strong> 点击"选择已有Bridge文件". 在对话框中选中之前已经使用过的Excel文件。这个文件应该保存有相应的数据并设定好Data Type。</p>
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <strong>Bridge按钮操作</strong>
                    <p>在面板上将会出现蓝色按钮"New Bridge"和"Refresh Bridge"。</p>
                    <div style="margin-left: 1rem; margin-top: 1rem;">
                        <p><strong>3.1</strong> "New Bridge"按钮，根据工作表Data的数据生成新的下拉菜单和Waterfall 工作表。(如原有工作表和waterfall，以及数据将会删除，将会出现提示）</p>
                        
                        <p><strong>3.2</strong> "Refresh Bridge"按钮 - 在1.1.1.1步骤中Key没有变化的情况下，通过筛选下拉菜单后，重新选择Base 和 Target数据集后，按下"Refresh Bridge"按钮，重新生成Waterfall 图表和Contribution Analysis分析。缺失数据或者工作表将会出现提示，建议运行New Bridge，重新生成新的Bridge。</p>
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">4</span>
                    <strong>下拉菜单配置</strong>
                    <p>下拉菜单将会分两个区域，Base 和 Target</p>
                    <p>Base 和 Target下拉菜单中的字段，每个字段包含的选项完全一样。用户可以根据需要在下拉菜单中筛选那些选项作为base数据，那些选项作为Target的数据。</p>
                    <div style="margin-left: 1rem; margin-top: 1rem;">
                        <p><strong>4.1</strong> Base下拉菜单 -选择分析比较的基础数据，例如我们经常将某些年份的数据作为比较的基础，则这里选择2023年</p>
                        <p><strong>4.2</strong> Target下拉菜单 - 选择分析比较的目标数据，例如这里选择2024年作为我们感兴趣的年份和2023年进行对比。</p>
                        <p>初始因为没有在Base 和 Target下拉菜单中重新筛选（默认所有字段都是全选），因此Base和Target得到的是完全一样的数据集，因此得到的是没有差异的waterfall。(如图）</p>
                    </div>
                    
                    <button class="example-btn" onclick="toggleExample('menu-example')">查看菜单配置示例</button>
                    <div id="menu-example" class="example-content">
                        <p><strong>示例场景：</strong>比较2023年vs 2024年的销售表现</p>
                        <p><strong>Base设置：</strong>年份=2023, 区域=全部, 产品类型=全部</p>
                        <p><strong>Target设置：</strong>年份=2024, 区域=全部, 产品类型=全部</p>
                        <p>这样设置后，Bridge将分析从2023到2024年各个因素对销售变化的具体贡献。</p>
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">5</span>
                    <strong>Waterfall 工作表是展示最终分析结果的工作表</strong>
                    <div style="margin-left: 1rem; margin-top: 1rem;">
                        <p><strong>5.1</strong> Waterfall 数据源 - 在左上角B3单元格开始，会出现字段名和数据，这是生成Waterfall图表使用的数据。</p>
                        <p><strong>5.2</strong> Waterfall - 显示经过程序运行后分析得到的Waterfall，左边的蓝色柱子为Base，中间为每个变量贡献的影响，右边柱子为Target.</p>
                        <p><strong>5.3</strong> Contribution Analysis 表格 - 在Waterfall 图像的正下方，将会显示Contribution Analysis表格，其中显示了对Key字段的每个Item，在不同的因素下对整体变化的贡献。</p>
                        <p>通过5.2 的 Waterfall  和 5.3的Contribution Analysis表格，将能够很快地找到影响变化的最主要Key Item，以及变化的因素（成本？折扣？还是价格？）</p>
                        <p>可以通过修改2.1中，选择哪个字段是Key，哪个字段是Result，来分析不同维度，不同的result数据。并且可以根据3下拉菜单来筛选那些数据为Base和Target，点击"Refresh Bridge"生成更新的waterfall</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Data Types Section -->
        <section id="data-types" class="instructions">
            <div class="container">
                <h2 class="section-title">数据类型详解</h2>
                <p style="text-align: center; margin-bottom: 2rem;">数据类型分为5种："Dimension"、"Key"、"SumY"、"SumN"、"Result"</p>
                
                <div class="data-types">
                    <div class="data-type-card">
                        <div class="data-type-title">Dimension</div>
                        <p>表示数据的维度，例如日期、时间、区域等数据的维度和切面，这些字段不参与计算，只用来筛选数据。</p>
                        
                        <button class="example-btn" onclick="toggleExample('dimension-example')">查看示例</button>
                        <div id="dimension-example" class="example-content">
                            <p><strong>示例：</strong>日期(2024-01-01)、区域(华东)、销售渠道(线上)</p>
                            <p>这些维度用于数据筛选和分组，不直接参与数值计算。</p>
                        </div>
                    </div>
                    
                    <div class="data-type-card">
                        <div class="data-type-title">Key</div>
                        <p>Key是Dimension的一种，只能有一个字段被标为Key。被标为Key的字段会作为分析的最小颗粒度，并在这个维度上计算每个因素对最终结果的影响。</p>
                        
                        <button class="example-btn" onclick="toggleExample('key-example')">查看示例</button>
                        <div id="key-example" class="example-content">
                            <p><strong>示例：</strong>如果将"产品"选为Key，Bridge将计算每个产品在各个变量变化下对最终结果的影响。</p>
                            <p>可以改变其他dimension为Key字段，进行不同颗粒度的分析。</p>
                        </div>
                    </div>
                    
                    <div class="data-type-card">
                        <div class="data-type-title">SumY</div>
                        <p>可以加总变量并且有意义的变量，程序将根据变量的变化计算出对最终结果的影响。可以直接输入数值，也可以使用公式计算。</p>
                        
                        <button class="example-btn" onclick="toggleExample('sumy-example')">查看示例</button>
                        <div id="sumy-example" class="example-content">
                            <p><strong>示例：</strong>商品数量(Quantity)、销售成本(Cost)、折扣金额(Discount)</p>
                            <p>这些数据可以跨产品加总：总数量 = 产品A数量 + 产品B数量</p>
                            <p><strong>公式示例：</strong>=Quantity * UnitCost</p>
                        </div>
                    </div>
                    
                    <div class="data-type-card">
                        <div class="data-type-title">SumN</div>
                        <p>Raw Data的一种，但这类型的数据无法在不同的产品、区域等Key之间相加。例如，Price是一个Non-additive数据。</p>
                        
                        <button class="example-btn" onclick="toggleExample('sumn-example')">查看示例</button>
                        <div id="sumn-example" class="example-content">
                            <p><strong>示例：</strong>商品价格(Price)、折扣率(Discount Rate)、利润率(Margin%)</p>
                            <p>这些数据不能直接加总：平均价格 ≠ 产品A价格 + 产品B价格</p>
                            <p>需要加权平均或其他计算方式处理。</p>
                        </div>
                    </div>
                    
                    <div class="data-type-card">
                        <div class="data-type-title">Result</div>
                        <p>只能有一个字段被选择为Result作为需要分析的数据结果。Result列必须输入公式，通过其他变量计算出Result字段。</p>
                        
                        <button class="example-btn" onclick="toggleExample('result-example')">查看示例</button>
                        <div id="result-example" class="example-content">
                            <p><strong>销售额示例：</strong>=Price * Quantity</p>
                            <p><strong>利润率示例：</strong>=Profit / Revenue</p>
                            <p><strong>注意：</strong>公式只能包含同一行的其他变量，不能跨行引用</p>
                            <p>Result公式中至少应该有一个SumY类型的字段。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Rules Section -->
        <section id="rules" class="instructions">
            <div class="container">
                <h2 class="section-title">6.SumY 和 SumN 运算规则</h2>
                
                <p style="margin-bottom: 2rem;">在Data工作表的第一行Data Type中，数值被分为两种类型SumY 和 SumN (Link)，并在Result一列中含有公式并使用这些数据。为了对数据进行正确的分析，这里我们定义了一些关于SumY 和 SumN的运算规则：（举例）</p>
                
                <div class="step">
                    <span class="step-number">6.1</span>
                    <strong>加法(减法）</strong>
                    <div style="margin-left: 2rem; margin-top: 1rem;">
                        <p>SumY + SumY = SumY</p>
                        <p>SumY + SumN (将会提示错误）</p>
                        <p>SumN + SumN = SumN</p>
                    </div>
                </div>
                
                <div class="step">
                    <span class="step-number">6.2</span>
                    <strong>乘法</strong>
                    <div style="margin-left: 2rem; margin-top: 1rem;">
                        <p>SumY * SumY = SumY</p>
                        <p>SumY * SumN = SumY</p>
                        <p>SumN * SumN = SumN</p>
                    </div>
                </div>
                
                <div class="step">
                    <span class="step-number">6.3</span>
                    <strong>除法</strong>
                    <div style="margin-left: 2rem; margin-top: 1rem;">
                        <p>SumY / SumY = SumN</p>
                        <p>SumY / SumN = SumY</p>
                        <p>SumN / SumY = SumN</p>
                        <p>SumN / SumN = SumN</p>
                    </div>
                </div>
                
                <p style="margin: 2rem 0;">根据具体字段的设定（SumN或者SumY)，一下的计算结果将无法被分析并出现错误提示，请修改公式或者字段类型的设定。</p>
                
                <div class="step">
                    <span class="step-number">6.4</span>
                    <strong>公式中的注意事项</strong>
                    <div style="margin-left: 1rem; margin-top: 1rem;">
                        <p><strong>6.4.1</strong> 在公式中，如果包含括号，则根据四则运算优先计算括号内的数据，结果作为值并运用上面的规则继续运算。（举例）</p>
                        
                        <button class="example-btn" onclick="toggleExample('bracket-example')">查看括号运算示例</button>
                        <div id="bracket-example" class="example-content">
                            <p><strong>示例：</strong> (SumY + SumY) * SumN</p>
                            <p>第一步：SumY + SumY = SumY</p>
                            <p>第二步：SumY * SumN = SumY</p>
                            <p>最终结果类型：SumY</p>
                        </div>
                        
                        <p><strong>6.4.2</strong> 每个人对字段的含义设定的SumY  和 SumN 可能有些不同，有可能导致运算的结果不符合预期，但是为了覆盖更广泛的使用场景，程序将使用上述的运算规则。（举例）</p>
                        
                        <button class="example-btn" onclick="toggleExample('setting-example')">查看字段设定示例</button>
                        <div id="setting-example" class="example-content">
                            <p><strong>场景：</strong>价格字段的不同理解</p>
                            <p><strong>理解A：</strong>价格设为SumN（不可加总）</p>
                            <p><strong>理解B：</strong>价格设为SumY（可加总的总价值）</p>
                            <p>程序会按照用户的设定执行相应的运算规则。</p>
                        </div>
                        
                        <p><strong>6.4.3</strong> 程序有时候会弹出错误提示，显示公式不符合和运算规则。请修改公式，以符合运算规则的要求。（举例）</p>
                        
                        <button class="example-btn" onclick="toggleExample('error-example')">查看错误提示示例</button>
                        <div id="error-example" class="example-content">
                            <p><strong>错误示例：</strong>Revenue = Cost(SumN) + Margin(SumN)</p>
                            <p><strong>错误原因：</strong>两个SumN类型不能直接相加</p>
                            <p><strong>解决方案：</strong>将Cost或Margin改为SumY类型，或修改公式逻辑</p>
                        </div>
                        
                        <p><strong>6.4.4</strong> 请使用简单清晰的公式，尽量少使用括号，这样将更容易进行分析。</p>
                        
                        <p><strong>6.4.5</strong> 如果Result一列得公式中引用了其他得单元格，而这个单元格也包含公式，则分析将会把所有引用嵌套的公式合并到一个公式中进行分析。(举例）</p>
                        
                        <button class="example-btn" onclick="toggleExample('nested-example')">查看嵌套公式示例</button>
                        <div id="nested-example" class="example-content">
                            <p><strong>示例：</strong></p>
                            <p>E列公式：=B*C （Total Cost = Quantity * Unit Cost）</p>
                            <p>F列Result公式：=D-E （Profit = Revenue - Total Cost）</p>
                            <p><strong>合并后：</strong>程序会分析 =D-(B*C)</p>
                        </div>
                        
                        <p><strong>6.4.6</strong> 程序将会根据公式的结构，自动进行变量的重新排序和使用乘法分配律，这样是为了更好的进行数据的分析。（举例）</p>
                        
                        <button class="example-btn" onclick="toggleExample('reorder-example')">查看变量排序示例</button>
                        <div id="reorder-example" class="example-content">
                            <p><strong>原始公式：</strong> =C*B+D*B</p>
                            <p><strong>程序处理后：</strong> =B*(C+D)</p>
                            <p>这样有助于更清晰地分析B、C、D各自的贡献。</p>
                        </div>
                        
                        <p><strong>6.4.7</strong> Waterfall图中每个factor出现的先后顺序原则上和Data工作表中factor从左到右的顺序一致，但是也有可能受到程序对公式中变量排序的影响。（举例）</p>
                        
                        <button class="example-btn" onclick="toggleExample('order-example')">查看因素顺序示例</button>
                        <div id="order-example" class="example-content">
                            <p><strong>Data工作表顺序：</strong>Price, Quantity, Discount</p>
                            <p><strong>公式：</strong> =Price * Quantity * (1-Discount)</p>
                            <p><strong>Waterfall顺序：</strong>可能为 Price → Quantity → Discount</p>
                            <p>顺序可能因公式结构优化而调整。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Process Section -->
        <section id="process" class="instructions">
            <div class="container">
                <h2 class="section-title">7. Process 工作表</h2>
                
                <p style="margin-bottom: 2rem;">Process工作表中包含了waterfall图表和数据产生的逻辑和算法，可以很直观的看到这些分析结果是如何一步一步计算出来的，避免了黑盒以及不能解释的现象。</p>
                
                <p style="margin-bottom: 1rem;"><strong>waterfall 分析计算逻辑和原理 (举例）</strong></p>
                
                <div class="step">
                    <span class="step-number">7.1</span>
                    <strong>基础计算步骤</strong>
                    <p>所有变量基于Base初始值，每一步改变一个变量成为Target的值，计算对于每一个Key Item的影响。</p>
                    
                    <button class="example-btn" onclick="toggleExample('step-by-step-example')">查看逐步计算示例</button>
                    <div id="step-by-step-example" class="example-content">
                        <p><strong>示例：</strong>产品A的销售额分析</p>
                        <p><strong>Base:</strong> Price=10, Quantity=100, Sales=1000</p>
                        <p><strong>Target:</strong> Price=12, Quantity=80, Sales=960</p>
                        <p><strong>步骤1:</strong> 只改变Price：10→12, Quantity保持100, Sales=1200</p>
                        <p><strong>步骤2:</strong> 再改变Quantity：Price=12, Quantity=100→80, Sales=960</p>
                    </div>
                </div>
                
                <div class="step">
                    <span class="step-number">7.2</span>
                    <strong>汇总影响计算</strong>
                    <p>计算每一步变量改变对汇总的影响</p>
                    
                    <button class="example-btn" onclick="toggleExample('summary-impact-example')">查看汇总影响示例</button>
                    <div id="summary-impact-example" class="example-content">
                        <p><strong>Price影响：</strong> 1200 - 1000 = +200</p>
                        <p><strong>Quantity影响：</strong> 960 - 1200 = -240</p>
                        <p><strong>总变化：</strong> +200 + (-240) = -40</p>
                        <p><strong>验证：</strong> 960 - 1000 = -40 ✓</p>
                    </div>
                </div>
                
                <div class="step">
                    <span class="step-number">7.3</span>
                    <strong>Bridge图表生成</strong>
                    <p>经过7.1 到7.2 将所有的变量从Base的值替换成Target的值，则获得Bridge图表所需的每个影响因素的impact.</p>
                </div>
                
                <div class="step">
                    <span class="step-number">7.4</span>
                    <strong>Contribution分析</strong>
                    <p>在Contribution计算表中将会计算每个Key在每个factor变化中对整体的影响。</p>
                    
                    <button class="example-btn" onclick="toggleExample('contribution-example')">查看Contribution分析示例</button>
                    <div id="contribution-example" class="example-content">
                        <p><strong>整体Price影响：</strong> +500</p>
                        <p><strong>产品A贡献：</strong> +200 (占40%)</p>
                        <p><strong>产品B贡献：</strong> +180 (占36%)</p>
                        <p><strong>产品C贡献：</strong> +120 (占24%)</p>
                    </div>
                </div>
                
                <div class="step">
                    <span class="step-number">7.5</span>
                    <strong>Added Data 和 Removed Data</strong>
                    <p>Added Data表示对于Base数据来说新加入的数据（在Target数据中存在）， Removed Data表示从Base数据中删除掉的数据（在Target中不存在）。这两类数据一般情况下需要先从其他factor的分析中剥离出来。(举例）</p>
                    
                    <button class="example-btn" onclick="toggleExample('add-remove-example')">查看Added/Removed Data示例</button>
                    <div id="add-remove-example" class="example-content">
                        <p><strong>场景：</strong>产品组合变化分析</p>
                        <p><strong>Base数据：</strong>产品A, B, C</p>
                        <p><strong>Target数据：</strong>产品A, B, D（新增D，移除C）</p>
                        <p><strong>Added Data：</strong>产品D的贡献</p>
                        <p><strong>Removed Data：</strong>产品C的影响（负贡献）</p>
                        <p>这些变化会单独显示，不与价格、数量等因素混合。</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Other Features Section -->
        <section id="features" class="instructions">
            <div class="container">
                <h2 class="section-title">8. 其他工作表</h2>
                <p style="margin-bottom: 2rem;">为了程序的正确运行，一些其他的工作表将会产生但是被隐藏起来，请不要打开并显示这些工作表。</p>
                
                <h2 class="section-title">9. 数据安全保障</h2>
                <p style="margin-bottom: 2rem;">所有的数据都只存在本地excel中，程序也只在本地运行，程序分析本身没有任何的网络通信</p>
                
                <h2 class="section-title">10. 透明可解释的分析</h2>
                <p style="margin-bottom: 1rem;">拒绝AI分析的模糊结论和不可解释性，分析计算过程完全透明并可以解释(举例）</p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">📊</div>
                        <h3>Process工作表透明度</h3>
                        <p>包含waterfall图表和数据产生的逻辑和算法，每个计算步骤都可以追溯和验证。</p>
                        
                        <button class="example-btn" onclick="toggleExample('transparency-example')">查看透明性对比</button>
                        <div id="transparency-example" class="example-content">
                            <p><strong>传统黑盒分析：</strong></p>
                            <p>❌ "AI模型显示利润率下降7pt"</p>
                            <p>❌ 无法解释具体计算过程</p>
                            <p>❌ 无法验证结果准确性</p>
                            <p><strong>Bridge透明分析：</strong></p>
                            <p>✅ "价格因素：-3pt, 成本因素：-2pt, 数量因素：-2pt"</p>
                            <p>✅ 每个计算步骤在Process工作表中可见</p>
                            <p>✅ 所有公式和逻辑完全可验证</p>
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">🔒</div>
                        <h3>本地数据安全</h3>
                        <p>零网络通信，所有数据处理在本地完成，确保企业数据绝对安全。</p>
                        
                        <button class="example-btn" onclick="toggleExample('security-example')">查看安全特性</button>
                        <div id="security-example" class="example-content">
                            <p><strong>数据安全保障：</strong></p>
                            <p>✅ 数据不离开本地电脑</p>
                            <p>✅ 无需上传到云端服务器</p>
                            <p>✅ 无网络连接要求</p>
                            <p>✅ 符合企业数据安全政策</p>
                            <p>✅ 避免数据泄露风险</p>
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">🎯</div>
                        <h3>精确数学计算</h3>
                        <p>基于严格的数学公式，确保分析结果的准确性和可靠性。</p>
                        
                        <button class="example-btn" onclick="toggleExample('accuracy-example')">查看精确性示例</button>
                        <div id="accuracy-example" class="example-content">
                            <p><strong>传统估算分析：</strong></p>
                            <p>❌ 人工估算，可能存在误差</p>
                            <p>❌ 各因素影响无法精确量化</p>
                            <p>❌ 汇总结果需要人工调整</p>
                            <p><strong>Bridge精确计算：</strong></p>
                            <p>✅ 数学公式保证100%准确</p>
                            <p>✅ 各因素贡献精确到小数位</p>
                            <p>✅ 总和自动平衡，无需调整</p>
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">⚡</div>
                        <h3>高效分析</h3>
                        <p>几分钟完成传统需要几天的复杂分析，大幅提升工作效率。</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">📈</div>
                        <h3>多维度分析</h3>
                        <p>支持按产品、区域、时间等多维度进行深入的驱动因素分析。</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">🔧</div>
                        <h3>灵活配置</h3>
                        <p>可以随时调整分析维度和对比场景，满足各种业务分析需求。</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Bridge - 智能数据分析工具. 即将在Microsoft Store发布.</p>
        </div>
    </footer>

    <script>
        function toggleExample(exampleId) {
            const example = document.getElementById(exampleId);
            const isVisible = example.classList.contains('show');
            
            // Hide all examples first
            document.querySelectorAll('.example-content').forEach(content => {
                content.classList.remove('show');
            });
            
            // Show the clicked example if it wasn't visible
            if (!isVisible) {
                example.classList.add('show');
            }
        }

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add scroll effect to header
        window.addEventListener('scroll', function() {
            const header = document.querySelector('header');
            if (window.scrollY > 100) {
                header.style.background = 'rgba(255, 255, 255, 0.98)';
            } else {
                header.style.background = 'rgba(255, 255, 255, 0.95)';
            }
        });
    </script>
</body>
</html>
